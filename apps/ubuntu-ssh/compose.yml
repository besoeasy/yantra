services:
  ubuntu-ssh:
    image: ubuntu:latest
    container_name: ubuntu-ssh
    command: >-
      bash -c "if [ ! -f /usr/sbin/sshd ]; then printf '#!/bin/sh\nexit 0\n' > /usr/sbin/policy-rc.d && chmod +x /usr/sbin/policy-rc.d && apt-get update -qq && DEBIAN_FRONTEND=noninteractive apt-get install -y --no-install-recommends openssh-server; fi && mkdir -p /var/run/sshd && echo 'root:$$SSH_ROOT_PASSWORD' | chpasswd && echo 'PermitRootLogin yes' >> /etc/ssh/sshd_config && echo 'PasswordAuthentication yes' >> /etc/ssh/sshd_config && /usr/sbin/sshd -D"
    environment:
      SSH_ROOT_PASSWORD: ${SSH_ROOT_PASSWORD:-rootpass}
    labels:
      yantr.app: "ubuntu-ssh"
      yantr.service: "Ubuntu Linux container with OpenSSH server â€” connect via SSH as root using a configurable password"
    ports:
      - "22"
    restart: unless-stopped
