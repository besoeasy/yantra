services:
  filepizza:
    image: kern/filepizza:latest
    container_name: filepizza
    labels:
      yantra.name: "FilePizza"
      yantra.category: "file-transfer,p2p"
      yantra.port: "3333 (HTTP - Web UI)"
      yantra.description: "Peer-to-peer file transfer directly in browser with zero-knowledge encryption"
      yantra.website: "https://github.com/kern/filepizza"
    ports:
      - "3333"
    environment:
      - PORT=${PORT:-3333}
      - EXTRA_ICE_SERVERS=${EXTRA_ICE_SERVERS:-turn:localhost:3478}
      - WEBTORRENT_TRACKERS=${WEBTORRENT_TRACKERS:-ws://localhost:28000}
    depends_on:
      - coturn
      - bittorrent-tracker
    restart: unless-stopped

  coturn:
    image: instrumentisto/coturn:latest
    container_name: filepizza_coturn
    ports:
      - "3478:3478/tcp"
      - "3478:3478/udp"
    restart: unless-stopped

  bittorrent-tracker:
    image: henkel/bittorrent-tracker:latest
    container_name: filepizza_tracker
    ports:
      - "8000"
    command:
      - npx
      - bittorrent-tracker
      - '--http-hostname'
      - 0.0.0.0
      - '--ws'
    restart: unless-stopped
